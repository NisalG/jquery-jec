(function($){$.fn.editableCombobox=function(options){var defaults={position:0,classes:'',styles:{},pluginClass:'jecEditableOption',useExistingOptions:false,ignoredKeys:[],acceptedRanges:[{min:32,max:126},{min:191,max:382}]};options=$.extend(defaults,options);if($.browser.msie){Array.prototype.indexOf=function(object){for(var i=0;i<this.length;i+=1){if(this[i]===object){return i;}}return-1;};}return $(this).filter('select').each(function(){var editableOption,i,lastKeyCode,specialKeys,getKeyCode,setEditableOption;if($(this).children(options.pluginClass).length===0){editableOption=$(document.createElement('option'));editableOption.addClass(options.pluginClass);if(typeof(options.classes)==='string'){editableOption.addClass(options.classes);}else if(typeof(options.classes)==='object'){for(i=0;i<options.classes.length;i+=1){editableOption.addClass(options.classes[i]);}}if(typeof(options.styles)==='object'){for(i=0;i<options.styles.length;i+=1){editableOption.append(options.styles[i]);}}if($(this).children().eq(options.position).length!==0){$(this).children().eq(options.position).before(editableOption);}else{$(this).append(editableOption);}}specialKeys=[46,37,38,39,40];getKeyCode=function(event){if(typeof(event.charCode)!=='undefined'&&event.charCode!==0){return event.charCode;}else{return event.keyCode;}};setEditableOption=function(elem){elem.children('option.'+options.pluginClass).val(elem.children('option:selected').text());};$(this).keydown(function(event){var keyCode,option,value;keyCode=getKeyCode(event);lastKeyCode=keyCode;switch(keyCode){case 8:case 46:option=$(this).children('option.'+options.pluginClass);if(option.val().length>=1){value=option.val().substring(0,option.val().length-1);option.val(value).text(value).attr('selected','selected');}return(keyCode!==8);default:break;}});$(this).keypress(function(event){var keyCode,keyValue,i,option,value,validKey;keyCode=getKeyCode(event);if(keyCode!==9){for(i=0;i<specialKeys.length;i+=1){if(keyCode===specialKeys[i]&&keyCode===lastKeyCode){return;}}if(options.ignoredKeys.indexOf(keyCode)===-1){$(this).children(':selected').removeAttr('selected');keyValue='';for(validKey in options.acceptedRanges){if((typeof(options.acceptedRanges[validKey].exact)!=='undefined'&&options.acceptedRanges[validKey].exact===keyCode)||(typeof(options.acceptedRanges[validKey].min)!=='undefined'&&typeof(options.acceptedRanges[validKey].max)!=='undefined'&&keyCode>=options.acceptedRanges[validKey].min&&keyCode<=options.acceptedRanges[validKey].max)){keyValue=String.fromCharCode(keyCode);}}option=$(this).children('option.'+options.pluginClass);value=option.val()+keyValue;option.val(value).text(value).attr('selected','selected');}}return false;});if(options.useExistingOptions){setEditableOption($(this));$(this).change(function(){setEditableOption($(this));});}});};})(jQuery);