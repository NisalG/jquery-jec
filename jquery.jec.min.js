(function($){$.jecCore={defaults:{position:0,classes:'',styles:{},pluginClass:'jecEditableOption',useExistingOptions:false,ignoredKeys:[],acceptedRanges:[{min:32,max:126},{min:191,max:382}]},options:null,ieHacks:function(){if($.browser.msie&&Array.prototype.indexOf===null){Array.prototype.indexOf=function(object){for(var i=0;i<this.length;i+=1){if(this[i]===object){return i;}}return-1;};}},getKeyCode:function(event){if(typeof(event.charCode)!=='undefined'&&event.charCode!==0){return event.charCode;}else{return event.keyCode;}},specialKeys:[46,37,38,39,40],lastKeyCode:null,setEditableOption:function(elem){elem.children('option.'+$.jecCore.options.pluginClass).val(elem.children('option:selected').text());},jecKeyDown:function(event){var keyCode,option,value;keyCode=$.jecCore.getKeyCode(event);$.jecCore.lastKeyCode=keyCode;switch(keyCode){case 8:case 46:option=$(this).children('option.'+$.jecCore.options.pluginClass);if(option.val().length>=1){value=option.val().substring(0,option.val().length-1);option.val(value).text(value).attr('selected','selected');}return(keyCode!==8);default:break;}},jecKeyPress:function(event){var keyCode,keyValue,i,option,value,validKey;keyCode=$.jecCore.getKeyCode(event);if(keyCode!==9){for(i=0;i<$.jecCore.specialKeys.length;i+=1){if(keyCode===$.jecCore.specialKeys[i]&&keyCode===$.jecCore.lastKeyCode){return;}}if($.jecCore.options.ignoredKeys.indexOf(keyCode)===-1){$(this).children(':selected').removeAttr('selected');keyValue='';for(validKey in $.jecCore.options.acceptedRanges){if((typeof($.jecCore.options.acceptedRanges[validKey].exact)!=='undefined'&&$.jecCore.options.acceptedRanges[validKey].exact===keyCode)||(typeof($.jecCore.options.acceptedRanges[validKey].min)!=='undefined'&&typeof($.jecCore.options.acceptedRanges[validKey].max)!=='undefined'&&keyCode>=$.jecCore.options.acceptedRanges[validKey].min&&keyCode<=$.jecCore.options.acceptedRanges[validKey].max)){keyValue=String.fromCharCode(keyCode);}}option=$(this).children('option.'+$.jecCore.options.pluginClass);value=option.val()+keyValue;option.val(value).text(value).attr('selected','selected');}return false;}},jecChange:function(){$.jecCore.setEditableOption($(this));},enable:function(options){$.jecCore.options=options;$.jecCore.options=$.extend($.jecCore.defaults,$.jecCore.options);$.jecCore.ieHacks();return $(this).filter('select').each(function(){var editableOption,i;if($(this).children($.jecCore.options.pluginClass).length===0){editableOption=$(document.createElement('option'));editableOption.addClass($.jecCore.options.pluginClass);if(typeof($.jecCore.options.classes)==='string'){editableOption.addClass($.jecCore.options.classes);}else if(typeof($.jecCore.options.classes)==='object'){for(i=0;i<$.jecCore.options.classes.length;i+=1){editableOption.addClass($.jecCore.options.classes[i]);}}if(typeof($.jecCore.options.styles)==='object'){for(i=0;i<$.jecCore.options.styles.length;i+=1){editableOption.append($.jecCore.options.styles[i]);}}if($(this).children().eq($.jecCore.options.position).length!==0){$(this).children().eq($.jecCore.options.position).before(editableOption);}else{$(this).append(editableOption);}}$(this).bind('keydown',$.jecCore.jecKeyDown);$(this).bind('keypress',$.jecCore.jecKeyPress);if($.jecCore.options.useExistingOptions){$.jecCore.setEditableOption($(this));$(this).bind('change',$.jecCore.jecChange);}});},disable:function(){return $(this).filter('select').each(function(){$(this).children('option.'+$.jecCore.options.pluginClass).remove();$(this).unbind('keydown',$.jecCore.jecKeyDown);$(this).unbind('keypress',$.jecCore.jecKeyPress);if($.jecCore.options!==null&&$.jecCore.options.useExistingOptions){$(this).unbind('change',$.jecCore.jecChange);}});}};$.fn.extend({jec:$.jecCore.enable,jecOff:$.jecCore.disable,editableCombobox:$.jecCore.enable});})(jQuery);